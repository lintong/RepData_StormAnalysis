---
title: "RepData Storm Data Analysis"
author: "Linton Galloway"
date: "22 October 2015"
output: html_document
---

## Synopsis



## Data Processing

```{r setup}
knitr::opts_chunk$set(cache=TRUE)

require(dplyr)
```


```{r data-download}
url     <- 'https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2'
tempf   <- tempfile()
download.file(url, tempf, method="curl")
DF      <- read.csv(bzfile(tempf))
```

```{r data-cleanup}

# clean-up by converting to lower case
DF      <- DF %>% mutate_each(funs(tolower), EVTYPE)

# use look-up table to futher align the data
lookup  <- read.csv('lookup.csv', colClasses = c("character","character"))

#ref: http://stackoverflow.com/questions/8214303/conditional-replacement-of-values-in-a-data-frame
DF$EVTYPE_NEW  <- lookup[match(DF$EVTYPE, lookup$old), 'new']
DF <- transform(DF, EVTYPE = ifelse(is.na(EVTYPE_NEW), EVTYPE, EVTYPE_NEW)) 



```


```{r generate-health-consequences}


# Generate an aggregate
injures_fatalities_by_evtype <- aggregate(cbind(FATALITIES, INJURIES)~EVTYPE, data=DF, sum)
injures_fatalities_by_evtype <- filter(injures_fatalities_by_evtype, FATALITIES != 0 | INJURIES != 0)
injures_fatalities_by_evtype
```

```{r generate-economic-consequences}

```

## Results

```{r publish-results}

```
